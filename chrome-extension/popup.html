<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%236C63FF'><path d='M13 2L3 14h9l-1 8 10-12h-9l1-8z'/></svg>">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="popup.css">
</head>
<body>
<div class="ad-form">
  <div class="ad-section">
    <div class="ad-header-row">
      <img src="hh-logo.png" alt="HH" style="width:25px;height:25px;border-radius:50%;flex-shrink:0">
      <h1>TextGen</h1>
      <div class="header-right">
        <button class="icon-btn" id="settingsBtn" title="Настройки"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M4 21v-7m0-4V3m8 18v-9m0-4V3m8 18v-5m0-4V3M2 14h4m4-6h4m4 8h4"/></svg></button>
      </div>
    </div>
    <div class="settings" id="sp">
      <div class="settings-inner"><div class="settings-content">
        <label>API-токен <span class="ts" id="ts">сохранён</span></label>
        <input type="password" id="apiToken" placeholder="вставьте токен llmgtw">
        <label>Модель</label>
        <select id="model">
          <option value="claude-haiku-4-5-20251001">Haiku 4.5 — быстрый</option>
          <option value="claude-sonnet-4-5-20250929" selected>Sonnet 4.5 — баланс</option>
          <option value="claude-opus-4-5-20251101">Opus 4.5 — умный</option>
        </select>
        <input type="hidden" id="maxTokens" value="4096">
        <label>Работа парсера</label>
        <div class="parser-mode-group">
          <button class="parser-mode-btn active" data-mode="auto">Автоматически</button>
          <button class="parser-mode-btn" data-mode="manual">Ручной с нормализацией</button>
        </div>
        <details class="prompt-editor" id="promptEditor">
          <summary>Системный промпт</summary>
          <textarea id="systemPromptText" placeholder="Системный промпт..."></textarea>
          <div class="prompt-editor-actions">
            <button class="prompt-reset-btn" id="promptResetBtn">Сбросить</button>
            <button class="prompt-save-btn" id="promptSaveBtn">Сохранить</button>
          </div>
        </details>
      </div></div>
    </div>
  </div>
  <div class="ad-section">
    <h3>Площадки</h3>
    <div class="platform-group">
      <div class="platform-group-title" data-platform="vk"><span class="dot"></span> VK</div>
      <div class="cb-grid">
        <label class="cb-pill" data-platform="vk"><input type="checkbox" value="vk_universal"><span>Универсальная</span></label>
        <label class="cb-pill" data-platform="vk"><input type="checkbox" value="vk_site"><span>Сайт</span></label>
        <label class="cb-pill" data-platform="vk"><input type="checkbox" value="vk_lead"><span>Лид-формы</span></label>
        <label class="cb-pill" data-platform="vk"><input type="checkbox" value="vk_carousel"><span>Карусель</span></label>
      </div>
    </div>
    <div class="platform-group">
      <div class="platform-group-title" data-platform="yandex"><span class="dot"></span> Яндекс.Директ</div>
      <div class="cb-grid">
        <label class="cb-pill" data-platform="yandex"><input type="checkbox" value="yandex_search"><span>Поиск</span></label>
        <label class="cb-pill" data-platform="yandex"><input type="checkbox" value="yandex_rsya"><span>РСЯ</span></label>
      </div>
    </div>
    <div class="platform-group">
      <div class="platform-group-title" data-platform="tg"><span class="dot"></span> Telegram</div>
      <div class="cb-grid">
        <label class="cb-pill" data-platform="tg"><input type="checkbox" value="telegram_seeds"><span>Посевы</span></label>
        <label class="cb-pill" data-platform="tg"><input type="checkbox" value="tgads"><span>TGads</span></label>
      </div>
    </div>
  </div>

  <div class="ad-section">
    <h3>Стиль</h3>
    <div class="style-selector" id="styleSelector">
      <input type="radio" name="adStyle" id="style-creative" value="creative">
      <label for="style-creative">Креативный</label>
      <input type="radio" name="adStyle" id="style-balanced" value="balanced" checked>
      <label for="style-balanced">Баланс</label>
      <input type="radio" name="adStyle" id="style-formal" value="formal">
      <label for="style-formal">Формальный</label>
    </div>
  </div>

  <div class="ad-section">
    <h3>Описание вакансии / контекст</h3>
    <div class="hh-url-row">
      <input type="text" id="hhUrlInput" placeholder="https://hh.ru/vacancy/123456">
      <button class="hh-url-btn" id="hhUrlBtn">Загрузить</button>
    </div>
    <div class="ad-divider">или</div>
    <div class="parse-row">
      <button class="parse-page-btn" id="parsePageBtn"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg> Спарсить текущую страницу</button>
      <button class="parse-normalize-btn" id="parseNormalizeBtn" title="Нормализация через AI"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z"/><path d="M20 4l1 3 1-3-1-3z"/><line x1="22" y1="1" x2="22" y2="1.01"/></svg> Нормализация</button>
    </div>
    <div class="ad-divider">или опишите вручную</div>
    <div class="desc-wrap">
      <textarea id="adDescription" placeholder="Опишите вакансию, ключевые преимущества, целевую аудиторию или вставьте текст лендинга..."></textarea>
      <button class="desc-clear" id="descClear" title="Очистить" style="display:none"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
    </div>
  </div>

  <div class="ad-actions">
    <button id="generateBtn">Сгенерировать</button>
  </div>

  <div class="ad-history-nav" id="historyNav" style="display:none">
    <button class="icon-btn-sm" id="historyPrev" title="Старше"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg></button>
    <span class="ad-history-pos" id="historyPos"></span>
    <button class="icon-btn-sm" id="historyNext" title="Новее"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg></button>
    <span class="ad-history-label" id="historyLabel"></span>
    <span class="ad-history-time" id="historyTime"></span>
    <button class="icon-btn-sm" id="historySearch" title="Поиск по истории"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg></button>
    <button class="icon-btn-sm del" id="historyDel" title="Удалить"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg></button>
  </div>
  <div class="history-search-panel" id="historySearchPanel">
    <div class="history-search-inner">
      <input type="text" id="historySearchInput" placeholder="Поиск по истории...">
      <div class="history-search-results" id="historySearchResults"></div>
    </div>
  </div>

  <div id="adResults">
    <div class="ad-empty" id="adEmpty">
      <div class="ad-empty-icon"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 013 3L7 19l-4 1 1-4z"/></svg></div>
      <p>Выберите площадки, стиль и опишите вакансию для генерации рекламных текстов</p>
    </div>
  </div>
</div>

<script src="popup.js"></script>
</body>
</html>
